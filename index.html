<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Support SmarterGerman</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <style>
    /* Reset and base styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      line-height: 1.6;
      color: #374151;
      padding: 2rem 1rem;
      background: #f9fafb;
    }
    
    /* Container */
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    /* Intro section */
    .intro {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      margin-bottom: 2rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .intro p {
      color: #4b5563;
      line-height: 1.7;
    }
    
    /* Support grid */
    .support-grid {
      display: grid;
      gap: 1rem;
    }
    
    /* Support item */
    .support-item {
      background: white;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .support-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .support-link {
      display: grid;
      grid-template-columns: 80px 24px 1fr;
      align-items: center;
      gap: 1rem;
      text-decoration: none;
      color: inherit;
    }
    
    /* Image container */
    .image-container {
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      overflow: hidden;
      background: #f3f4f6;
    }
    
    .support-icon {
      width: 100%;
      height: 100%;
      object-fit: contain;
      transition: filter 0.3s, opacity 0.3s;
    }
    
    .support-icon.grayscale {
      filter: grayscale(100%);
      opacity: 0.7;
    }
    
    /* Fallback for missing images */
    .support-icon:not([src]), 
    .support-icon[src=""],
    .support-icon:broken {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 32px;
      font-weight: bold;
    }
    
    .support-icon:not([src])::before,
    .support-icon[src=""]::before {
      content: attr(data-fallback);
    }
    
    /* Check mark */
    .check-container {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .check-container.show {
      opacity: 1;
    }
    
    .check-icon {
      width: 24px;
      height: 24px;
    }
    
    /* Text content */
    .support-text {
      font-size: 1rem;
      color: #1f2937;
    }
    
    .support-link:hover .support-text {
      color: #2563eb;
      text-decoration: underline;
    }
    
    /* Visited state */
    .support-item.visited .support-icon {
      filter: none;
      opacity: 1;
    }
    
    .support-item.visited .check-container {
      opacity: 1;
    }
    
    /* Responsive */
    @media (max-width: 640px) {
      .support-link {
        grid-template-columns: 60px 20px 1fr;
      }
      
      .image-container {
        width: 60px;
        height: 60px;
      }
      
      .check-container,
      .check-icon {
        width: 20px;
        height: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Intro Section -->
    <section class="intro">
      <p>
        Dear SmarterGerman Learner,<br><br>
        Your support means the world to me. Running a business is not as simple as just charging money, 
        and your help makes a real difference. Below, you'll find several ways you can contribute to 
        improving my courses and keeping SmarterGerman alive and growing.<br><br>
        Thank you from the bottom of my heart for being such an important part of this journey and 
        for supporting my work.
      </p>
    </section>

    <!-- Support Options Grid -->
    <section class="support-grid" aria-label="Ways to support SmarterGerman">
      
      <!-- Google Review -->
      <div class="support-item" data-item-id="googlereview">
        <a href="https://g.page/r/CQJM3OGGTRuFEBM/review" 
           target="_blank" 
           rel="noopener noreferrer"
           class="support-link"
           data-support-id="googlereview">
          <div class="image-container">
            <img src="images/googlereview.png" 
                 alt="Google Review" 
                 class="support-icon grayscale"
                 data-used-src="images/googlereview.png">
          </div>
          <div class="check-container">
            <img src="images/checkicon.png" alt="Completed" class="check-icon">
          </div>
          <span class="support-text">Leave a review on Google</span>
        </a>
      </div>

      <!-- YouTube Subscribe -->
      <div class="support-item" data-item-id="youtube">
        <a href="https://www.youtube.com/c/smarterGermanBerlin?sub_confirmation=1" 
           target="_blank" 
           rel="noopener noreferrer"
           class="support-link"
           data-support-id="youtube">
          <div class="image-container">
            <img src="images/youtube.png" 
                 alt="YouTube" 
                 class="support-icon grayscale"
                 data-used-src="images/youtube.png">
          </div>
          <div class="check-container">
            <img src="images/checkicon.png" alt="Completed" class="check-icon">
          </div>
          <span class="support-text">Subscribe to SG on YouTube</span>
        </a>
      </div>

      <!-- Easy Reader -->
      <div class="support-item" data-item-id="easyreader">
        <a href="https://smartergerman.com/courses/easy-reader-german-b1-milk/" 
           target="_blank" 
           rel="noopener noreferrer"
           class="support-link"
           data-support-id="easyreader">
          <div class="image-container">
            <img src="images/others.png" 
                 alt="Easy Reader" 
                 class="support-icon grayscale"
                 data-used-src="images/others.png">
          </div>
          <div class="check-container">
            <img src="images/checkicon.png" alt="Completed" class="check-icon">
          </div>
          <span class="support-text">Get one of my Easy Readers</span>
        </a>
      </div>

      <!-- Oral Exam Preparation -->
      <div class="support-item" data-item-id="examprep">
        <a href="https://deutschgym.com/?via=michael" 
           target="_blank" 
           rel="noopener noreferrer"
           class="support-link"
           data-support-id="examprep">
          <div class="image-container">
            <img src="images/exampreparation_icon.png" 
                 alt="Oral Exam Preparation" 
                 class="support-icon grayscale"
                 data-used-src="images/exampreparation_icon.png">
          </div>
          <div class="check-container">
            <img src="images/checkicon.png" alt="Completed" class="check-icon">
          </div>
          <span class="support-text">Oral Exam Preparation â€“ Deutschgym</span>
        </a>
      </div>

      <!-- Refer a Friend -->
      <div class="support-item" data-item-id="referral">
        <a href="https://sso.teachable.com/secure/263787/current_user/refer_a_friend" 
           target="_blank" 
           rel="noopener noreferrer"
           class="support-link"
           data-support-id="referral">
          <div class="image-container">
            <img src="images/fwb.png" 
                 alt="Refer a Friend" 
                 class="support-icon grayscale"
                 data-used-src="images/fwb.png">
          </div>
          <div class="check-container">
            <img src="images/checkicon.png" alt="Completed" class="check-icon">
          </div>
          <span class="support-text">Friends with benefits</span>
        </a>
      </div>

      <!-- Personal Support Membership -->
      <div class="support-item" data-item-id="membership">
        <a href="https://smartergerman.com/memberships/#member" 
           target="_blank" 
           rel="noopener noreferrer"
           class="support-link"
           data-support-id="membership">
          <div class="image-container">
            <img src="images/psg-icon-inactive.png" 
                 alt="Personal Support Membership" 
                 class="support-icon grayscale"
                 data-used-src="images/psg-icon-active.png">
          </div>
          <div class="check-container">
            <img src="images/checkicon.png" alt="Completed" class="check-icon">
          </div>
          <span class="support-text">Personal Support Membership</span>
        </a>
      </div>

    </section>
  </div>

  <script>
    // Support tracking system with localStorage persistence
    class SupportTracker {
      constructor() {
        this.storageKey = 'sgSupportClicked';
        this.clickedItems = this.loadState();
        this.init();
      }

      // Load saved state from localStorage
      loadState() {
        try {
          return JSON.parse(localStorage.getItem(this.storageKey) || '{}');
        } catch (e) {
          console.error('Error loading state:', e);
          return {};
        }
      }

      // Save state to localStorage
      saveState() {
        try {
          localStorage.setItem(this.storageKey, JSON.stringify(this.clickedItems));
        } catch (e) {
          console.error('Error saving state:', e);
        }
      }

      // Initialize the tracker
      init() {
        // Restore previously clicked items
        this.restoreClickedItems();
        
        // Add click listeners
        this.attachClickListeners();
      }

      // Restore visual state for previously clicked items
      restoreClickedItems() {
        Object.keys(this.clickedItems).forEach(id => {
          if (this.clickedItems[id]) {
            this.applyClickedState(id);
          }
        });
      }

      // Attach click listeners to all support links
      attachClickListeners() {
        document.querySelectorAll('[data-support-id]').forEach(link => {
          link.addEventListener('click', (e) => {
            const id = link.getAttribute('data-support-id');
            this.markAsClicked(id);
          });
        });
      }

      // Mark an item as clicked
      markAsClicked(id) {
        this.clickedItems[id] = true;
        this.saveState();
        this.applyClickedState(id);
      }

      // Apply visual state for clicked items
      applyClickedState(id) {
        const item = document.querySelector(`[data-item-id="${id}"]`);
        if (!item) return;

        // Add visited class to the item
        item.classList.add('visited');

        // Update icon
        const icon = item.querySelector('.support-icon');
        if (icon) {
          icon.classList.remove('grayscale');
          
          // Swap to "used" icon if different
          const usedSrc = icon.getAttribute('data-used-src');
          if (usedSrc && usedSrc !== icon.src) {
            icon.src = usedSrc;
          }
        }

        // Show checkmark
        const checkContainer = item.querySelector('.check-container');
        if (checkContainer) {
          checkContainer.classList.add('show');
        }
      }

      // Clear all clicked items (utility method)
      clearAll() {
        this.clickedItems = {};
        this.saveState();
        location.reload();
      }
    }

    // Handle image loading errors
    function handleImageError(img) {
      const fallback = img.getAttribute('data-fallback');
      if (fallback) {
        // Create a placeholder with the fallback text
        img.style.display = 'none';
        const placeholder = document.createElement('div');
        placeholder.className = 'image-placeholder';
        placeholder.textContent = fallback;
        img.parentElement.appendChild(placeholder);
      }
    }

    // Add error handlers to all images
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.support-icon').forEach(img => {
        img.onerror = () => handleImageError(img);
      });
    });

    // Initialize tracker when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        new SupportTracker();
      });
    } else {
      new SupportTracker();
    }
  </script>
</body>
</html>
